<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>simrail.alekswilc.dev</title>
    <meta name="description" content="Simrail Utils">
    <meta property="og:title" content="simrail.alekswilc.dev">
    <meta property="og:url" content="https://simrail.alekswilc.dev">
    <meta property="og:description" content="Simrail Utils">
    <meta property="og:type" content="website">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/open-fonts@1.1.1/fonts/inter.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css">

    <style>
        p {
            margin: 1%;
        }
    </style>
</head>

<body>
    <%- include('../_modules/header.ejs', { section: 'trains' }) %>

    <h2>Wyszukaj pociąg, osobe lub serwer</h2>

    <div class="container">
        <input type="text" id="search" value="<%-q%>">
        <button onclick="search()">Szukaj</button>
        <button onclick="clearSearch()">Wyczyść</button>

        <p>Użyj przecinka, aby wyszukać wiele wartości: pl2,1413</p>
    </div>

    <ul>
        <% records.forEach(record=> { %>
            <li>
                <details>
                    <summary>[<span style="color:lightskyblue">
                            <%- record.server.toUpperCase() %>
                        </span>] <span style="color: lightskyblue">
                            <%- record.trainName %>
                        </span> - <span style="color: lightskyblue">
                            <%- record.trainNumber %>
                        </span> - <span style="color:hotpink">
                            <%- record.userUsername %>
                        </span>
                        <p style="margin-bottom: 0; opacity: 0.5;">
                            <%- dayjs(record.leftDate).format('HH:mm DD/MM/YYYY') %>
                        </p>
                    </summary>
                    <p>Data dołączenia: <%- record.joinedDate ? dayjs(record.joinedDate).format('HH:mm DD/MM/YYYY')
                            : '--:-- --/--/--' %> (<%- record.joinedDate ? dayjs(record.joinedDate).fromNow() : '--' %>)
                    </p>
                    <p>Data wyjścia: <%- dayjs(record.leftDate).format('HH:mm DD/MM/YYYY') %> (<%-
                                dayjs(record.leftDate).fromNow() %>)</p>
                    <p>Spędzony czas: <%- record.joinedDate ? msToTime(record.leftDate - record.joinedDate) : '--' %>
                    <% if (record.distance) { %>
                        <p>Przejechane kilometry: <%- record.distance / 1000 %></p>
                        <p>Zdobyte punkty: <%- record.points %></p>
                    <% } %>
                    </p>

                    <a href="/trains/details/<%- record.id %>">
                        <button>Więcej</button>
                    </a>
                </details>
            </li>
            <% }) %>
    </ul>

    <% if (!records.length) { %>
        <h4>Nie znaleziono wyników dla twojego zapytania.</h4>
    <% } %>

    <hr>
    <%- include('../_modules/footer.ejs', { thanks: false }) %>

    <script>
        function search() {
            location.href = '/trains/?q=' + document.getElementById('search').value
        }
        function clearSearch() {
            console.log('test')
            location.href = '/trains/';
        }
        document.getElementById('search').addEventListener("keyup", (event) => {
            if (event.key === "Enter")
                search();

        });
    </script>

</body>

</html>